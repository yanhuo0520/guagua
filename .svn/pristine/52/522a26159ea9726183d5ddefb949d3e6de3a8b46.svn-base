webpackJsonp([4],{"0Gqc":function(t,e,i){t.exports=i.p+"static/img/b8o.e436396.png"},"406M":function(t,e,i){t.exports=i.p+"static/img/bac.1cc8a92.png"},"6ozB":function(t,e,i){t.exports=i.p+"static/img/b5t.0146ed7.png"},"8KtV":function(t,e,i){t.exports=i.p+"static/img/tixian.fb51b07.png"},EA9Z:function(t,e,i){t.exports=i.p+"static/img/close.4ed9e9b.png"},KOY8:function(t,e,i){t.exports=i.p+"static/img/solo.67bea0d.png"},Msht:function(t,e,i){t.exports=i.p+"static/img/jinyan.f80d6cb.png"},OgMS:function(t,e){},VnSw:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("mvHQ"),a=i.n(s),o=i("cVr7"),n={name:"ChatInput",data:function(){return{group_number:"",userInfo:"",openoption:!1,showRedInfo:!1,messList:[],redPackInfo:"",group_name:"",group_user:0,scroll:"",paramsId:0,packetMsg:"",clickPackCache:"",currPage:1,is_full_group:!1,socketNotice:"",ws:"",disableScroll:!1,isActiveLeave:!1}},watch:{$route:function(t,e){["Record","SendPack","Rule","GroupSetting","Qrcode","Details","ChatFuli","GroupUserList"].includes(this.$route.name)?(this.ws||this.socketConnect(),this.scroll.refresh()):(this.isActiveLeave=!0,this.ws.close()),this.showRedInfo=!1},messList:function(){var t=this;this.$nextTick(function(){t.scroll.refresh(),0==t.disableScroll&&t.scroll.scrollTo(0,t.scroll.maxScrollY,300)})}},activated:function(){var t=this;this.paramsId=this.$config.fuli_number,this.group_number=this.$config.fuli_number,this.group_name=this.$config.fuli_title,document.title=this.$config.fuli_title,this.scroll&&this.$nextTick(function(){t.scroll.refresh(),t.scroll.scrollTo(0,t.scroll.maxScrollY,0)})},mounted:function(){this.scrollInit(),this.$route.query.token&&(this.$setItem("userInfo",""),this.$setItem("token",this.$route.query.token)),this.socketConnect()},methods:{scrollInit:function(){this.scroll=new o.a(this.$refs.wrapper,{probeType:3,click:!0})},uiChatNotice:function(t){this.$dialog.toast({mes:'<div style="color: #fff;">'+t+"</div>",timeout:2e3})},socketConnect:function(){var t=this;t.Loading("连接中..."),this.ws=new WebSocket("ws://"+this.$socketUrl+":"+this.$config.fuli),t.ws.onopen=function(){t.ws.send(a()({type:"init",data:{token:t.$getItem("token"),group_type:18,group_number:t.$config.fuli_number}}))},t.ws.onmessage=function(e){(new auiToast).hide();var i=JSON.parse(e.data);if("@heart@"==i.type)return t.ws.send(a()({type:"@heart@",data:{}})),!0;if(i.data&&i.data.group_number==t.$config.fuli_number){var s=i.data;switch(i.type){case"init":t.is_full_group=!1,s.chatinfo&&(t.group_user=s.chatinfo.group_user),t.userInfo=s.uinfo?s.uinfo:s.user,s.chatinfo&&(t.messList=t.hanld(s.chatinfo.data)),t.$nextTick(function(){t.scroll.refresh(),t.scroll.scrollTo(0,t.scroll.maxScrollY,0)});break;case"ApiPacketDetail":200!=(s=s.red_detail).status_code?t.socketAlert(s.message,function(){}):1e3==s.status_code?t.$router.push({path:"/details/"+s.data.id+"/"+t.$config.fuli_number}):(t.showRedInfo=!0,t.redPackInfo={id:s.data.id,status:s.data.red_status,desc:s.data.remark,red_lei:s.data.red_lei,status_code:s.data.status_code,userInfo:{uid:s.data.user.id,avatar:t.webUrl+"/upload/"+s.data.user.avatar,nickname:s.data.user.name}}),t.$nextTick(function(){t.scrollToBottom()});break;case"sendRedPacket":t.messList&&t.messList.length>50&&t.messList.shift();var o=t.messList.length;for(var n in t.messList)n<o-4&&(t.messList[n].is_empty=1);t.messList.push(s);break;case"RedPacketSurplus":for(var c=s.packet_id,r=0,l=t.messList.length;r<l;r++)if(t.messList[r].packetInfo&&t.messList[r].packetInfo.packedID==c){t.messList[r].packetInfo.surplus=s.surplus;break}break;case"ApiRobRedPacket":if(200==s.code){var u=s.red_id;for(r=0,l=t.messList.length;r<l;r++)if(t.messList[r].id==u){t.messList[r].is_empty=1,t.showRedInfo=!1,t.clickPackCache+=u+",",1!=s.no_redirect&&(t.$playOpenMusic("music"),t.$router.push({path:"/details/"+t.redPackInfo.id+"/"+t.$config.fuli_number}));break}}t.openoption=!1;break;case"GroupChatInfo":var d=s.red_id;for(r=0,l=t.messList.length;r<l;r++)if(t.messList[r].id==d&&t.messList[r].userInfo.uid==s.user_id){t.messList[r].my_rob_detail={all_amount:s.all_amount,rob_amount:s.rob_amount,is_kui:s.is_kui,status:s.red_status},t.messList[r].is_empty=1,t.messList[r].packetInfo.status=1,t.messList[r].my_rob=s.rob_amount>0?1:0,t.$nextTick(function(){t.scrollToBottom()});break}break;case"globalNotice":t.socketNotice=s.message,t.$refs.socketNotice.classList.add("active"),setTimeout(function(){t.$refs.socketNotice.classList.remove("active")},s.time);break;case"error":402==s.code?(t.openoption=!1,t.clickPackCache+=t.redPackInfo.id+",",t.packetMsg=i.message,t.redPackInfo.status=2,t.redPackInfo.status_code=1e3):t.socketAlert(i.message,function(){t.openoption=!1,401==s.code&&(t.$chkViewType()?window.location.href=t.webUrl+"/wechat?url=home":t.$router.push({path:"/login"})),"不存在该群"==i.message&&(t.$setItem("cacheJoinList",""),t.$router.back())})}}},t.ws.onclose=function(){t.ws="",t.messList=[],(new auiToast).hide(),t.isActiveLeave||t.socketAlert("连接断开，将返回游戏大厅！",function(){t.$router.back()})},t.ws.onerror=function(){(new auiToast).hide(),t.socketAlert("目前服务器访问量巨大，请稍候再试！",function(){t.$router.back()})}},hanld:function(t){for(var e in t){var i=1,s=t[e];0==s.my_rob&&(i=s.packetInfo.status),s.is_empty=i}return t},pushToUrl:function(t){this.$router.push({path:t})},forward:function(){var t=this;this.userInfo.mobile?this.$router.push({path:"/forward"}):this.$dialog.confirm({title:"<div class='aui-font-size-20 aui-padded-15' style='color: #000;'><b>您还未认证账号，为了您的账户安全请先认证！</b></div>",mes:"",opts:function(){t.$router.push({path:"/bind"})}})},showRedPacket:function(t){this.Loading(),this.openoption=!1,this.sendSocketMsg("ApiPacketDetail",{red_id:t})},openRedPacket:function(t){var e=this;this.clickPackCache.indexOf(this.redPackInfo.id)<0&&(this.openoption=!0,this.clickPackCache+=this.redPackInfo.id+",",this.$httpRequest("ApiRobRedPacket","post",{red_id:this.redPackInfo.id},function(t){e.openoption=!1,200==t.status_code?(e.showRedInfo=!1,e.$playOpenMusic("music"),e.$router.push({path:"/details/"+e.redPackInfo.id+"/"+e.$config.fuli_number})):(e.packetMsg=t.message,e.redPackInfo.status=2,e.redPackInfo.status_code=1e3)}))},openRedPacket1:function(t){this.clickPackCache.indexOf(this.redPackInfo.id)<0&&(this.openoption=!0,this.sendSocketMsg("ApiRobRedPacket",{red_id:this.redPackInfo.id}))},showRedDetails:function(){this.showRedInfo=!1,this.$router.push({path:"/details/"+this.redPackInfo.id+"/"+this.$config.fuli_number})},hideRedInfo:function(){this.showRedInfo=!1},scrollToBottom:function(){this.scroll.refresh(),this.scroll.scrollTo(0,this.scroll.maxScrollY,100)},closeOut:function(){window.history.length<=2&&this.$router.push({path:"/"})},showGroupRule:function(){this.$router.push({path:"/rule/"+this.$config.fuli_number})},globalAlert:function(t,e){(new auiDialog).alert({title:"温馨提示",msg:t,buttons:["确定"]},function(t){e()})},Loading:function(t){(new auiToast).loading({title:t||"加载中",duration:1e4},function(t){})},friendTimeShow:function(t){t=t.replace(/-/g,"/"),t=new Date(t).getTime()/1e3;var e=(new Date).getTime();return(e=parseInt((e-1e3*t)/1e3))<60?"刚刚":e<3600&&e>=60?Math.floor(e/60)+"分钟前":e<86400&&e>=3600?Math.floor(e/60/60)+"小时前":e<259200&&e>=86400?Math.floor(e/60/60/24)+"天前":(t=new Date(1e3*parseInt(t))).getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},sendSocketMsg:function(t,e){e.token=this.$getItem("token"),e.group_type=18,e.group_number=this.$config.fuli_number,this.ws.send(a()({type:t,data:e}))},socketAlert:function(t,e){this.$dialog.alert({mes:'<div class="aui-font-size-20 aui-padded-15 aui-text-left" style="color: #000;line-height: 25px;">'+t+"</div>",callback:function(){e&&e()}})}}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"wrapper",staticClass:"wrapper"},[s("div",{ref:"aui-chat",staticClass:"aui-chat",staticStyle:{height:"auto!important","padding-top":"4rem"}},[t._l(t.messList,function(e,a){return e.userInfo?s("div",{key:a,staticClass:"aui-chat-item aui-chat-left"},[t._m(0,!0),t._v(" "),s("div",{staticClass:"aui-chat-inner"},[s("div",{staticClass:"aui-chat-name aui-font-size-14",staticStyle:{"margin-bottom":"5px!important"}},[t._v("全民扫雷官方")]),t._v(" "),s("div",{staticClass:"aui-chat-content ",class:{"chat-right":e.userInfo.uid==t.userInfo.id,"chat-left":e.userInfo.uid!=t.userInfo.id,"lottery-empty":1==e.is_empty,"luck-packet":"lucky"==e.type},on:{click:function(i){return t.showRedPacket(e.packetInfo.packedID)}}},[s("span",{staticClass:"lottery ",class:{"chat-triangle-right":e.userInfo.uid==t.userInfo.id,"chat-triangle-left":e.userInfo.uid!=t.userInfo.id}}),t._v(" "),s("div",{staticClass:"lottery-lucky-up"},[1==e.is_empty?s("img",{staticClass:"lottery-img",attrs:{src:i("406M")}}):s("img",{staticClass:"lottery-img",attrs:{src:i("p/hx")}}),t._v(" "),s("div",{staticClass:"lottery-content"},[s("div",{staticClass:"aui-text-left",staticStyle:{"margin-top":"2px"}},[s("span",{staticStyle:{"font-size":"18px"}},[s("b",{staticClass:"ng-binding"},[t._v(t._s(e.packetInfo.title))])])]),t._v(" "),s("div",{staticClass:"aui-text-left",staticStyle:{"margin-top":"-5px"}},[s("span",{staticClass:"ng-binding",staticStyle:{"font-size":"12px"}},[t._v(t._s(e.packetInfo.desc?e.packetInfo.desc:"恭喜发财，大吉大利！"))])])])]),t._v(" "),s("div",{staticClass:"lottery-down"},[s("div",{staticClass:"ng-binding aui-text-left",staticStyle:{"line-height":"25px","font-size":"12px",color:"#999","margin-left":"10px"}},[t._v("\n\t\t\t\t\t\t\t"+t._s(e.packetInfo.packetType)+"\n\t\t\t\t\t\t\t"),s("span",{staticClass:"red-count aui-pull-right"},[t._v("\n\t\t\t\t\t\t\t\t"+t._s(t.friendTimeShow(e.created_at))+"\n\t\t\t\t\t\t\t\t"),s("img",{staticStyle:{"vertical-align":"middle",display:"inline-block"},attrs:{src:i("KOY8"),width:"16",alt:""}})])])])])])]):t._e()}),t._v(" "),s("div",{ref:"Safari",staticClass:"aui-clear"}),t._v(" "),s("div",{staticClass:"aui-clearfix",staticStyle:{height:"2.5rem"}})],2),t._v(" "),s("div",{ref:"socketNotice",staticClass:"socket-notice"},[t._m(1),t._v(" "),s("div",{staticClass:"notice-content",domProps:{innerHTML:t._s(t.socketNotice)}})]),t._v(" "),s("header",{staticStyle:{"box-shadow":"0 1px 11px 2px rgba(42, 42, 42, .1)",height:"3.3rem",overflow:"hidden",width:"100%",position:"fixed",top:"0",left:"0",right:"0",background:"#ededed"}},[s("ul",{staticClass:"aui-list aui-media-list",staticStyle:{background:"#ededed!important","padding-top":"5px"}},[s("li",{staticClass:"aui-list-item aui-list-item-middle",staticStyle:{background:"#ededed!important"}},[s("div",{staticClass:"aui-media-list-item-inner"},[s("div",{staticClass:"aui-list-item-media",staticStyle:{width:"2rem",padding:"0"}},[s("img",{staticStyle:{"border-radius":"0.1875rem",width:"40px",height:"40px"},attrs:{src:t.webUrl+"/upload/"+t.userInfo.avatar}})]),t._v(" "),s("div",{staticClass:"aui-list-item-inner aui-padded-l-5"},[s("div",{staticClass:"aui-list-item-text"},[s("div",{staticClass:"aui-list-item-title aui-font-size-14"},[t._v("游戏ID: "),s("span",{staticClass:"aui-font-size-14",staticStyle:{"font-weight":"500",color:"rgb(239, 69, 58)"}},[t._v(t._s(t.userInfo.unique_id))])]),t._v(" "),s("div",{staticClass:"aui-list-item-right"},[s("div",{staticClass:"aui-text-center aui-font-size-12",staticStyle:{position:"absolute","z-index":"999",right:"0px",top:"-15px",width:"2rem",color:"#000","font-weight":"700"},on:{click:function(e){return t.pushToUrl("/")}}},[s("img",{staticStyle:{margin:"auto","border-radius":"3px"},attrs:{src:i("zUfB"),width:"25"}}),t._v("返回\n\t\t\t\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"aui-text-center aui-font-size-12",staticStyle:{position:"absolute","z-index":"999",right:"35px",top:"-15px",width:"2rem",color:"#000","font-weight":"700"},on:{click:function(e){return t.pushToUrl("/recharge")}}},[s("img",{staticStyle:{margin:"0.15625rem auto 0.1rem auto","border-radius":"3px"},attrs:{src:i("qZcM"),width:"20"}}),t._v("充值\n\t\t\t\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"aui-text-center aui-font-size-12",staticStyle:{position:"absolute","z-index":"999",right:"75px",top:"-15px",width:"2rem",color:"#000","font-weight":"700"},on:{click:t.forward}},[s("img",{staticStyle:{margin:"auto","border-radius":"3px"},attrs:{src:i("8KtV"),width:"25"}}),t._v("提现\n\t\t\t\t\t\t\t\t")]),t._v(" "),s("div",{staticClass:"aui-text-center aui-font-size-12",staticStyle:{position:"absolute","z-index":"999",right:"115px",top:"-15px",width:"2rem",color:"#000","font-weight":"700"},on:{click:function(e){return t.pushToUrl("/qrcode/928bdf/全民扫雷")}}},[s("img",{staticStyle:{margin:"0.15625rem auto 0.1rem auto","border-radius":"3px"},attrs:{src:i("plJe"),width:"20"}}),t._v("分享\n\t\t\t\t\t\t\t\t")])])]),t._v(" "),s("div",{staticClass:"aui-list-item-text nomarl aui-font-size-14"},[t._v("金   币:  "),s("span",{staticStyle:{"font-weight":"700"}},[t._v(t._s(t.userInfo.balance))])])])])])])]),t._v(" "),t._m(2),t._v(" "),1==t.showRedInfo?s("div",{staticClass:"redpacket"},[s("div",{staticClass:"packet-content bounceIn animated"},[s("div",{staticClass:"rednorth"},[s("div",{staticClass:"avatar"},[s("img",{attrs:{src:t.redPackInfo.userInfo.avatar}})]),t._v(" "),s("div",{staticClass:"nickName aui-text-center"},[t._v(t._s(t.redPackInfo.userInfo.nickname))]),t._v(" "),s("div",{staticClass:"red-notice aui-font-size-20 aui-text-center"},[0==t.redPackInfo.status?s("span",[t._v("恭喜发财，大吉大利")]):2==t.redPackInfo.status?s("span",[t._v(t._s(t.packetMsg))]):s("span",[t._v("手慢了，红包已领完")])]),t._v(" "),s("div",{staticClass:"aui-font-size-20 aui-text-center aui-margin-t-10",staticStyle:{color:"#ffe2b1"},attrs:{id:"redgame-desc"}},[t._v(t._s(t.redPackInfo.desc))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.redPackInfo.red_lei,expression:"redPackInfo.red_lei"}],staticClass:"aui-font-size-20 aui-text-center aui-margin-t-10",staticStyle:{color:"#ffe2b1"},attrs:{id:"redgame-desc"}},[t._v("\n\t\t\t\t\t雷值: "+t._s(t.redPackInfo.red_lei)+"\n\t\t\t\t")]),t._v(" "),s("div",{staticClass:"open",staticStyle:{"font-weight":"bolder"}},[1002!=t.redPackInfo.status_code?s("a",{staticClass:"aui-font-size-16",attrs:{href:"javascript:;"},on:{click:t.showRedDetails}},[t._v("查看大家的手气>")]):s("img",{class:{openAnimation:t.openoption},attrs:{src:i("6ozB"),"red-id":"redPackInfo.id",width:"100",alt:""},on:{click:t.openRedPacket}})])]),t._v(" "),t._m(3)]),t._v(" "),s("div",{staticClass:"close",on:{click:t.hideRedInfo}},[s("img",{attrs:{src:i("EA9Z"),width:"45",alt:""}})])]):t._e()])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"aui-chat-media"},[e("img",{attrs:{src:i("ZXbz")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"notice-title"},[e("img",{attrs:{src:i("iQH9"),alt:""}}),this._v("\n\t\t\t全民扫雷官方\n\t\t\t"),e("span",{staticClass:"aui-pull-right aui-text-default aui-font-size-12",staticStyle:{"font-weight":"normal"}},[this._v("现在")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("footer",{staticClass:"aui-text-center",staticStyle:{position:"fixed",bottom:"0",right:"0",left:"0",background:"#f5f5f5",height:"60px","line-height":"60px",color:"#c2c2c2"}},[e("img",{attrs:{src:i("Msht"),width:"100%",height:"100%",alt:""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"redpacket-footer"},[e("img",{attrs:{src:i("0Gqc"),width:"20",alt:""}})])}]};var r=i("VU/8")(n,c,!1,function(t){i("OgMS")},"data-v-ae5107bc",null);e.default=r.exports},ZXbz:function(t,e,i){t.exports=i.p+"static/img/redpacket.3ac70b8.png"},"p/hx":function(t,e,i){t.exports=i.p+"static/img/redpack.0d953a3.png"},plJe:function(t,e,i){t.exports=i.p+"static/img/fenxiang.5edaa0a.png"},qZcM:function(t,e,i){t.exports=i.p+"static/img/chongzhi.e1047f6.png"},zUfB:function(t,e,i){t.exports=i.p+"static/img/fanhui.c45e7c5.png"}});